 抢课助手 2.1.2 使用说明
##由zyrf-cl开发
## 📋 目录
- [程序简介](#程序简介)
- [系统要求](#系统要求)
- [安装与配置](#安装与配置)
- [配置文件说明](#配置文件说明)
- [使用步骤](#使用步骤)
- [功能特性](#功能特性)
- [常见问题](#常见问题)
- [注意事项](#注意事项)
- [故障排除](#故障排除)

## 🎯 程序简介

抢课助手是一个基于 Playwright 的自动化选课工具，专为汕头大学选课系统设计。程序支持专业课和公选课的自动搜索与选课，具有智能重试、过滤器管理、配置文件等高级功能。

**⚠️ 重要声明：此程序仅供学习交流使用，请勿滥用！**

## 💻 系统要求

- **操作系统**：Windows 10/11
- **Python**：3.7 或更高版本
- **浏览器**：Chrome、Edge 或其他 Chromium 内核浏览器
- **网络**：稳定的校园网连接

## 🚀 安装与配置

### 方法一：使用可执行文件（推荐）
1. 下载 `抢课助手.exe` 文件
2. 将程序放在任意文件夹中
3. 确保 `config.txt` 配置文件与程序在同一目录
4. 双击运行程序

### 方法二：Python 源码运行
1. 安装 Python 依赖：
   ```bash
   pip install playwright
   playwright install chromium
   ```
2. 下载源码文件 `抢课助手2.1.1.py`
3. 运行程序：
   ```bash
   python 抢课助手2.1.1.py
   ```

## ⚙️ 配置文件说明

程序支持通过 `config.txt` 文件进行个性化配置：

```ini
# 登录信息
username=你的学号
password=你的密码
# 课程名称：留空则手动输入
course_name=
# 课程屏蔽设置
# 屏蔽课程列表：用逗号分隔多个课程名称，留空则不屏蔽任何课程
# 示例：blocked_courses=高等数学,大学物理,线性代数
# 当搜索结果中出现这些课程时，程序会自动跳过不选择
blocked_courses=

# 选课设置
course_type=              # 课程类型：1=专业课，2=公选课，留空则手动选择
enable_filter=            # 是否过滤已满课程：y=是，n=否，留空则手动选择

# 延时设置（单位：秒）
search_interval=2          # 搜索间隔时间
click_interval=0.5         # 点击间隔时间
filter_wait=0.3           # 过滤器等待时间
page_load_wait=2          # 页面加载等待时间

# 重试设置
browser_retries=3         # 浏览器重试次数
login_retries=3           # 登录重试次数
enter_course_attempts=10  # 选课按钮查找最大尝试次数
```

### 配置说明：

#### 登录信息
- `username`：你的学号，留空则程序启动时提示输入
- `password`：你的密码，留空则程序启动时提示输入

#### 延时设置
- `search_interval`：每次搜索之间的间隔时间，网络慢可适当增加
- `click_interval`：点击选课链接之间的间隔时间
- `filter_wait`：过滤器设置后的等待时间
- `page_load_wait`：页面加载的等待时间

#### 重试设置
- **设置为 999 时表示无限重试**，直到用户手动终止（Ctrl+C）
- `browser_retries`：浏览器启动失败时的重试次数
- `login_retries`：登录失败时的重试次数
- `enter_course_attempts`：查找"进入选课"按钮的最大尝试次数

## 📖 使用步骤

### 1. 启动程序
- 双击 `抢课助手.exe` 或运行 Python 脚本
- 程序会自动读取配置文件

### 2. 登录验证
- 如果配置文件中设置了账号密码，程序会自动使用
- 否则会提示手动输入学号和密码

### 3. 浏览器选择
程序会自动检测系统中的浏览器：
- 找到浏览器：自动使用检测到的浏览器
- 未找到：提供三个选项
  1. 手动输入浏览器路径
  2. 使用内置浏览器（推荐）
  3. 退出程序

### 4. 进入选课系统
- 程序自动登录并进入选课系统
- 支持多次重试，直到成功进入

### 5. 选择课程类型
```
选专业课还是公选课？(1：专业课/2：公选课)#只用输入1或2:
```
- 输入 `1` 选择专业课
- 输入 `2` 选择公选课

### 6. 过滤器设置
```
是否要过滤已满课程？(y/n，默认y):
```
- 输入 `y` 或直接回车：只显示有名额的课程
- 输入 `n`：显示所有课程（包括已满的）

### 7. 搜索选课
```
请输入课程名称:
```
- 输入课程名称或关键词
- 程序开始自动搜索并选课
- 支持模糊搜索

### 8. 自动选课过程
- 程序每2秒自动重新搜索（可配置）
- 找到课程后立即尝试选课
- 显示选课结果和状态
- 按 `Ctrl+C` 可中断搜索，回到手动输入

## ✨ 功能特性

### 🔄 智能重试机制
- **浏览器重试**：启动失败时自动重试
- **登录重试**：登录失败时自动重试
- **无限重试模式**：设置为999时持续重试直到成功

### 🎯 精准选课
- **多种定位方式**：支持多种选课链接识别方法
- **过滤器管理**：智能管理已满课程过滤
- **实时状态检查**：实时检查选课结果

### ⚡ 高效搜索
- **自动重搜**：未找到课程时自动重新搜索
- **模糊匹配**：支持课程名称模糊搜索
- **快速响应**：优化的等待时间和超时设置

### 🛡️ 安全保护
- **弹窗处理**：自动处理系统弹窗
- **异常恢复**：遇到错误时自动恢复
- **用户控制**：支持随时中断操作

## ❓ 常见问题

### Q1: 程序提示"未找到浏览器"怎么办？
**A1:** 
1. 选择"使用Playwright内置浏览器"（推荐）
2. 或手动输入浏览器完整路径，如：
   ```
   C:\Program Files\Google\Chrome\Application\chrome.exe
   ```

### Q2: 登录失败怎么办？
**A2:**
1. 检查账号密码是否正确
2. 确认网络连接正常
3. 检查是否已在其他地方登录选课系统
4. 程序会自动重试，也可以设置无限重试模式

### Q3: 搜索不到课程怎么办？
**A3:**
1. 检查课程名称是否正确
2. 尝试使用课程关键词而非全名
3. 确认选择的课程类型（专业课/公选课）是否正确
4. 程序会自动重复搜索

### Q4: 选课失败显示"人数已满"？
**A4:**
1. 这是正常现象，说明课程确实已满
2. 程序会继续搜索，等待有人退课
3. 可以尝试搜索其他课程

### Q5: 如何设置无限重试？
**A5:**
在 `config.txt` 中将相应的重试次数设置为 999：
```ini
browser_retries=999
login_retries=999
enter_course_attempts=999
```

## ⚠️ 注意事项

### 使用前准备
1. **退出其他登录**：使用脚本前请退出正在登录的选课系统
2. **网络稳定**：确保校园网连接稳定
3. **时间充足**：选课高峰期可能需要较长等待时间

### 使用过程中
1. **不要关闭浏览器**：程序运行时不要手动关闭浏览器窗口
2. **耐心等待**：网络卡顿时程序可能响应较慢
3. **及时确认**：选课成功后请手动确认结果

### 选课成功后
1. **手动退出**：选课完成后记得点击"安全退出"
2. **确认结果**：登录选课系统确认选课结果
3. **保存截图**：建议保存选课成功的截图作为凭证

## 🔧 故障排除

### 程序无法启动
1. 检查是否安装了必要的依赖
2. 确认 Python 版本是否符合要求
3. 尝试以管理员身份运行

### 浏览器启动失败
1. 更新浏览器到最新版本
2. 尝试使用内置浏览器
3. 检查系统防火墙设置

### 页面加载缓慢
1. 增加配置文件中的等待时间
2. 检查网络连接质量
3. 避开选课高峰期使用

### 选课链接点击失败
1. 检查是否开启了过滤器
2. 确认课程确实有名额
3. 尝试手动刷新页面

## 📞 技术支持

如遇到其他问题，请：
1. 检查程序输出的错误信息
2. 确认配置文件设置是否正确
3. 尝试重启程序
4. 查看程序日志获取详细错误信息

---

**最后提醒：请合理使用本程序，遵守学校相关规定，不要给服务器造成过大压力。祝您选课顺利！** 🎓

